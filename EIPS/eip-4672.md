---
eip: 4672
title: address.nonce
description: A new EVM opcode to get the current nonce of an EOA.
author: 0xfoobar (@0xfoobar)
discussions-to: https://ethereum-magicians.org/t/eip-4672-todo
status: Draft
type: Standards Track
category: Core
created: 2022-02-01
requires: none
---

## Abstract

We propose an additional EVM opcode, `address.nonce` (0x47), which could provide novel protection against sybil attacks and expand the smart contract design space. This would return `0` for an unused externally-owned address (EOA), `0` for a smart contract address, and, for example, `2` for an EOA which has sent 3 transactions. The account.nonce opcode would exactly track the nonce of the last transaction originating from that address.

A full list of EVM opcodes can be tracked here: https://github.com/crytic/evm-opcodes

## Motivation

NFT contracts commonly use checks on `msg.sender` to limit sybil attacks. However, this is easily circumvented by spinning up new addresses, or even nesting address creation within a smart contract. Letting smart contracts check `address.nonce` would add additional costs to this, serving as a “proof of history”. While not bulletproof (as msg.sender is not), it opens up the design space to creative uses.

## Specification

A new opcode is added to the EVM, 0x47, which can be used in Solidity as follows:

```solidity
address account = 0x0000000000000000000000000000000000000000;
uint256 nonce = account.nonce; // should be 0
```

## Rationale

The EVM makes several global variables available, examples include `block.timestamp`, `block.number`, `block.difficulty`, `msg.sender`, and `gasleft()`. It also provides several context-dependent opcodes, such as `EXTCODESIZE`, `BASEFEE`, and `BALANCE` Smart contracts can leverage these info for novel techniques, such as staking pool emissions, limiting flashloan attacks, or NFTs that embed blockchain state into their mint result.

It is useful to gather information about interacting addresses. NFT minting is an immediate usecase, and it follows that as much information about the underlying blockchain state should be made available to smart contracts.


## Implementation

Not provided yet, would need to be integrated into Ethereum clients as this is an EVM modification. However, clients already check the account nonce on each transaction to ensure validity, so exposing this data as an opcode should not add significant processing or development load.


## Copyright

Copyright and related rights waived via [CC0](https://creativecommons.org/publicdomain/zero/1.0/).

